*
* $Id: backzf.F,v 1.1.1.1 1996/04/01 15:03:18 mclareni Exp $
*
* $Log: backzf.F,v $
* Revision 1.1.1.1  1996/04/01 15:03:18  mclareni
* Mathlib gen
*
*
#include "sys/CERNLIB_machine.h"
#include "_gen/pilot.h"
      SUBROUTINE BACKZF(I,N)
C  BACKZF SEARCHES BACKWARD FOR A FILE MARK ON TAPE I EITHER IN
C  BINARY (DEFAULT) MODE (N=1) OR IN BCD MODE (N=0).
C  BACKZF IS PROVIDED FOR COMPATIBILITY PURPOSES ONLY.  ITS USE IS
C  STRONGLY DISCOURAGED.  USERS ARE INSTEAD INVITED TO CONSIDER
C  THE USE OF THE FORTRAN RANDOM ACCESS FACILITIES
C  (READMS,WRITMS) - SEE THE FORTRAN EXTENDED REFERENCE MANUAL.
C
C  CERN LIBRARY PROGRAM K404
C  L. POPE - DECEMBER 1971
C
      CALL REMARK(44HBACKZF - CALL MADE TO SUBROUTINE BACKZF(I,N))
      L=1
      CALL NOARG(M)
      IF (M.LT.2) GO TO 101
      IF (N.EQ.0) GO TO 201
      GO TO 101
C  BINARY BACKZF
100   L=L+1
      BACKSPACE I
101   BACKSPACE I
      READ (I)
      J=IOCHEC(I)
      IF (EOF(I).EQ.0.) GO TO 100
      BACKSPACE I
      IF (L.LE.20) RETURN
      CALL REMARK(50HBACKZF - MORE THAN 20 BACKSPACES EXECUTED (BINARY))
      RETURN
C  BCD BACKZF
200   L=L+1
      BACKSPACE I
201   BACKSPACE I
      READ (I,1) A
1     FORMAT(A10)
      J=IOCHEC(I)
      IF (EOF(I).EQ.0.) GO TO 200
      BACKSPACE I
      IF (L.LE.20) RETURN
      CALL REMARK(47HBACKZF - MORE THAN 20 BACKSPACES EXECUTED (BCD))
      RETURN
      END

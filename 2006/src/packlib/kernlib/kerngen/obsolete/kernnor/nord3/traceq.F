*
* $Id: traceq.F,v 1.1.1.1 1996/02/15 17:54:50 mclareni Exp $
*
* $Log: traceq.F,v $
* Revision 1.1.1.1  1996/02/15 17:54:50  mclareni
* Kernlib
*
*
#include "kernnor/pilot.h"
      SUBROUTINE TRACEQ (LUNP,NP)
C
C CERN PROGLIB# N105    TRACEQ          .VERSION KERNNOR  1.07  810629
C ORIG.  H.OVERAS, CERN, 810622
C
C ROUTINE TO PRINT TRACEBACK INFORMATION: MEMORY ADDRESSES OF
C ROUTINE ENTRIES,VBAS AND CALLING LOCATION.  IT DOES NOT PROVIDE
C SYMB SOURCE INFORM LIKE SUBR NAMES AND LINE NUMBER OF CALLS!
C
      COMMON /SLATE/ NAM1,NAM2,LINE,LADR,LOK,LWK(35)
      LUN=LUNP
      N=NP
C     IF(LUN.EQ.0) LUN=LUNDEF
      WRITE(LUN,9021)
      LINE=0
      LOK=0
      CALL TRAC1Q
24    N=N-1
      CALL TRAC2Q
      IF(LOK) 31,25,99
25    WRITE(LUN,9025) NAM1,NAM2,LADR
C     WRITE(1,8000) LWK
      IF(N.GT.0) GOTO 24
      RETURN
31    WRITE(LUN,9031)
99    RETURN
9021  FORMAT(7H0TRACEQ)
9025  FORMAT(' CALLED FROM ROUT ENTADDR:',O11,'  VBAS:',O11,
     + '   AT LOC:',O11)
9031  FORMAT(26H ******* TRACE ENDS BADLY.)
8000  FORMAT(16(X,O3))
      END
#ifdef CERNLIB_TCGEN_TRACEQ
#undef CERNLIB_TCGEN_TRACEQ
#endif

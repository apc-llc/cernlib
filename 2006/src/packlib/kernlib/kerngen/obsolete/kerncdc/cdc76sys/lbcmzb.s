*
* $Id: lbcmzb.s,v 1.1.1.1 1996/02/15 17:51:30 mclareni Exp $
*
* $Log: lbcmzb.s,v $
* Revision 1.1.1.1  1996/02/15 17:51:30  mclareni
* Kernlib
*
*
          IDENT  LBCMZB
*
* CERN PROGLIB# Z028    LBCMZB          .VERSION KERNCDC  1.13  820111
*
*  LBCMZB MEASURES THE LENGTH OF BLANK COMMON AVAILABLE
*  (NOT NECESSARILY THE DECLARED LENGTH) THAT IS, FROM THE
*  START OF BLANK COMMON TO THE END OF THE USER-S CENTRAL
*  MEMORY SPACE.
*
*  CERN LIBRARY PROGRAM Z 028
*  THIS VERSION USES THE MEMORY MACRO TO DETERMINE FIELD LENGTH,
*  SO AS TO BE INDEPENDENT OF THE FORTRAN COMMON LIBRARY.
*  J.D.BLAKE/CERN   8 APRIL 1976
*
          ENTRY  LBCMZB
* FUNCTION LBCMZB(DUMMY)
          VFD    42/0LLBCMZB,18/LBCMZB
 LBCMZB   EQ     *+1S17
*
*         INVOKE MEMORY MACRO TO DETERMINE SCM FIELD LENGTH
*
          MX6    0
          SA6    MEMSTAT           PREPARE REQUEST/REPLY WORD
          MEMORY SCM,MEMSTAT,RECALL
          SA3    MEMSTAT           READ REPLY
*
*         SUBTRACT START ADDRESS OF BLANK COMMON AND RETURN RESULT
*
          SX2    BLANK             START OF BLANK COMMON
          AX3    30                SCM FIELD LENGTH
          IX6    X3-X2             LENGTH OF BLANK COMMON
          EQ     LBCMZB            RETURN
*
 MEMSTAT  DATA   0                 MEMORY MACRO REQUEST/REPLY WORD
*
          USE    //
 BLANK    BSS    1                 FIRST LOCATION IN BLANK COMMON
          END

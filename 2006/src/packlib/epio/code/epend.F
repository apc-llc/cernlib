*
* $Id: epend.F,v 1.1.1.1 1996/03/08 15:21:43 mclareni Exp $
*
* $Log: epend.F,v $
* Revision 1.1.1.1  1996/03/08 15:21:43  mclareni
* Epio
*
*
#include "epio/pilot.h"
      SUBROUTINE EPEND(LUNIT,IBUF,IERR)
C. ROUTINE TO CLOSE OUTPUT UNIT AND TO WRITE END OF FILE MARK.
C. WRITING MAY CONTINUE AFTERWARDS ON SAME UNIT.
C. CLOSING AN INPUT UNIT HAS NO EFFECT.
C.
C. +++  MANDATORY AT END OF JOB FOR ALL OUTPUT UNITS +++
C. +++  OR A CALL TO EPCLOS (NO EOF WRITTEN)         +++
C.
C.
C. INPUT:
C.
C. LUNIT    LOGICAL UNIT NUMBER
C.
C. INPUT/OUTPUT:
C.
C. IBUF     USER PROVIDED UNIT BUFFER. MUST NOT BE TOUCHED BY USER.
C.
C. OUTPUT:
C.
C. IERR     ERROR FLAG. SEE SEPARATE LIST.
C.
#include "epio/epiocom.inc"
      DIMENSION IBUF(2)
C--- GET UNIT NUMBER
      IF(LUNIT.NE.LASTUT)  CALL EPUREF(LUNIT)
      IF(LREF.EQ.0)  GOTO 9901
C--- START-1 OF CONTROL WORDS
      IF(LIST(ISTART+14).EQ.0.OR.LIST(ISTART+16).NE.1)  GOTO 77777
      CALL EPBOUT(IBUF,IERR)
      CALL EPEOF(LUNIT,IERR)
77777 RETURN
 9901 CONTINUE
C--- UNIT DOES NOT EXIST
      IERR=14
      CALL EPERRH(LUNIT,IERR)
      GOTO 77777
      END

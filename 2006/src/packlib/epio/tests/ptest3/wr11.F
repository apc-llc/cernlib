*
* $Id: wr11.F,v 1.1.1.1 1996/03/08 15:21:46 mclareni Exp $
*
* $Log: wr11.F,v $
* Revision 1.1.1.1  1996/03/08 15:21:46  mclareni
* Epio
*
*
#if !defined(CERNLIB_ND100B16)
#include "pilot.h"
      SUBROUTINE WR11
C--- WRITES TEST DATA
#include "testc.inc"
      ICALL=0
      LUNIT=11
      CALL EPSTAT
      DO 10  ILWORD=16,32,16
      CALL EPSETW(LUNIT,3,ILWORD,IERR)
      IF(IERR.NE.0)  CALL ERREX(21)
      DO 11  ISPAN=1,1
      DO 12  IPAD=1,3
#if (!defined(CERNLIB_STF77))&&(!defined(CERNLIB_STF77VX))
      CALL EPSETW(LUNIT,8,10*(ISPAN-1)+IPAD,IERR)
#endif
#if defined(CERNLIB_STF77)||defined(CERNLIB_STF77VX)
      CALL EPSETW(LUNIT,8,10*(ISPAN-1)+  1 ,IERR)
#endif
      IF(IERR.NE.0)  CALL ERREX(22)
      DO 13  MODE=1,3
      N=NWOUT
      IF(MODE.EQ.1.AND.ILWORD.EQ.16)  N=2*NWOUT
      DO 14  JREC=1,NREC
      IH(9)=MODE
      ICALL=ICALL+1
      IH(8)=ICALL
      CALL VFILL(IDAT,NWOUT,ICALL)
      IF(MODE.EQ.1)  CALL BUN32W(IDAT,1,IPAC,1,NWOUT)
      IF(MODE.NE.1)  CALL UCOPY(IDAT,IPAC,NWOUT)
      CALL EPOUTL(LUNIT,MODE,NH,IH,N,IPAC,IBUF11,IERR)
      IF(IERR.NE.0)  CALL ERREX(23)
   14 CONTINUE
   13 CONTINUE
      CALL EPCLOS(LUNIT,IBUF11,IERR)
      IF(IERR.NE.0)  CALL ERREX(24)
   12 CONTINUE
   11 CONTINUE
   10 CONTINUE
C--- DUMMY CALL FOR TEST
      CALL EPCLOS(LUNIT,IBUF11,IERR)
      CALL EPSTAT
      RETURN
      END
#endif

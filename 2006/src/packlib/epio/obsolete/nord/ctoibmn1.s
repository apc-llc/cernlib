*
* $Id: ctoibmn1.s,v 1.1.1.1 1996/03/08 15:21:55 mclareni Exp $
*
* $Log: ctoibmn1.s,v $
* Revision 1.1.1.1  1996/03/08 15:21:55  mclareni
* Epio
*
*
#if defined(CERNLIB_ND100B32)
%      SUBROUTINE CTOIB(ARRAY,NW)
%      +++++++NORD10/100 VERSION++++++++++
%      VERSION 1-12-81
%      CONVERT FIRST NW WORDS OF ARRAY INTO IBM FORMAT
%      ON RETURN,ARRAY CONTAINS CONVERTED VALUES.
)9BEG;)9LIB CTOIB;)9ENT CTOIB;
CTOIB,SWAP SA DB;COPY SL DD;STD SAVEB;
LDX I 1,B;RADD SX DX;LDA 0,B;RADD SX DA;COPY SA DB;COPY CM2 SX DX;
LOOP=*;
LDD 0,B,X;COPY SA DL;BSET ZRO 170 DA;COPY SA DT;
SHA ZIN SHR 6;AAA 3;STA SAVE;SHA ZIN SHR 2;STA CHIBM;SHA ZIN 2;STA MEM;
LDA SAVE;SUB MEM;AAA -2;AND (77;ADD INSTR;STA CODE;
LDA CHIBM;JAF CONT1;SAA 0;COPY SA DD;JMP ENDR;
CONT1=*;
BSKP ONE 70 DA;JMP CONT2;LDD MAXND;JMP ENDR;
CONT2=*;
SHA ZIN 10;STA CHIBM;
COPY ST DA;AND (77;BSET ONE 60 DA;
CODE,SAD ZIN 0;ADD CHIBM;ENDR,BSKP ZRO 170 DL;BSET ONE 170 DA;
STD 0,B,X;RINC DX;JNC LOOP;
XTOIB,LDD SAVEB;COPY SA DB;COPY SD DP;
SAVEB,0;0;
SAVE,0;
CHIBM,0;
MEM,0;
INSTR,SAD ZIN 0;
MAXND,77777;177777;
)FILL;)9END;
#endif

*
* $Id: supinit.F,v 1.1.1.1 1996/04/01 15:03:19 mclareni Exp $
*
* $Log: supinit.F,v $
* Revision 1.1.1.1  1996/04/01 15:03:19  mclareni
* Mathlib gen
*
*
#include "sys/CERNLIB_machine.h"
#include "_gen/pilot.h"
      SUBROUTINE SUPINIT(NFIC)
#if defined(CERNLIB_NOSBE)
C--
C-- INITIALISING CALL FOR SUPRLAY FOR NOSBE
C-- MUST BE CALLED FIRST WITH THE FILE NAME OF THE ROOT OVERLAY
C-- THIS IS TO FIND THE LHHA FIELD OF THE EACP LOADER TABLE (TABLE ID=54)
C-- THIS FIELD IN THE ROOT OVERLAY IS THE MAXIMUM USER LCM ADDRESS USED
C-- NOTE THE MEMORY MACRO RETURNS ONLY THE JCL REQUESTED ECS VALUE
C--
      COMMON/AUXBST/LSTBST,LBLBST,LB2BST,MAXBST,NLMBST,LFRBST,LOWBST
      DIMENSION MESSGY(9), UDUMMY(20), MESSGX(6)
      DATA MESSGY / 10HSUPINIT CA, 10HLLED WITH , 10H          ,
     +              10H,USER LCM=, 10H          , 10H OCTAL =  ,
     +              10H          ,10H DECIMAL   , 0/
      DATA MESSGX / 10HSUPINIT, E, 10HCS FREE FO, 10HR SUPRLAY ,
     +              10H          , 10H OCTAL    , 0/
      DATA LSTBST / 0/
#endif
#if (defined(CERNLIB_F4))&&(defined(CERNLIB_NOSBE))
      DATA KBL/1R /
#endif
#if (!defined(CERNLIB_F4))&&(defined(CERNLIB_NOSBE))
      DATA KBL/R" "/
#endif
#if defined(CERNLIB_NOSBE)
C-- CHANGE FILE NAME TO L FORMAT. NFIC MUST BE THE ROOT OVERLAY NAME.
      NFICC=AND(NFIC,MASK(42))
      DO 21  I=1,10
      NFICC=SHIFT(NFICC,6)
      IF(JBYT(NFICC,1,6).NE.KBL) GOTO 21
      NFICC=AND(NFICC,MASK(54))
   21 CONTINUE
#endif
#if (defined(CERNLIB_F4))&&(defined(CERNLIB_NOSBE))
C-- SET RT=S,BT=C IN THE FIT
      CALL SUOPEN (NFICC,0,0)
#endif
#if defined(CERNLIB_NOSBE)
      REWIND NFICC
      READ (NFICC) UDUMMY,LSTBST
      ENCODE (10,1000,MESSGY(3)) NFIC
      ENCODE (10,1001,MESSGY(5)) LSTBST
      ENCODE (10,1002,MESSGY(7)) LSTBST
      CALL REMARK (MESSGY)
C-- FIND THE MAXIMUM ECS FROM JOB OR RFL JCL CARDS
      CALL SUPLCM (0,MAXECS,IERR)
      MAXADD= MAXECS - LSTBST
C-- REDUCE TO USER VALUE TO ALLOW FOR LATER DYNAMIC INCREASES
      CALL SUPLCM(-MAXADD,LSTBST,IERR)
      ENCODE (10,1003,MESSGX(4)) MAXADD
      CALL REMARK (MESSGX)
 1000 FORMAT(A10)
 1001 FORMAT(O10)
 1002 FORMAT(I10)
 1003 FORMAT(O10)
#endif
      RETURN
      END

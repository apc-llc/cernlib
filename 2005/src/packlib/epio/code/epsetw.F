*
* $Id: epsetw.F,v 1.1.1.1 1996/03/08 15:21:44 mclareni Exp $
*
* $Log: epsetw.F,v $
* Revision 1.1.1.1  1996/03/08 15:21:44  mclareni
* Epio
*
*
#include "epio/pilot.h"
      SUBROUTINE EPSETW(LUNIT,NUMBER,IW,IERR)
C.
C. INPUT:
C.
C. LUNIT    LOGICAL UNIT.
C.
C. NUMBER   NO. OF STATUS WORD TO BE CHANGED (SEE LIST ABOVE).
C.
C. IW       NEW VALUE OF STATUS WORD.
C.
C. OUTPUT:
C.
C. IERR     ERROR FLAG. SEE SEPARATE LIST.
C.
#include "epio/epiocom.inc"
      IF(NUMBER.LE.0.OR.NUMBER.GT.LIST(7).AND.NUMBER.LT.25)  GOTO 9901
C--- CHECK WHETHER SAME USER UNIT AS LAST TIME
      IF(LASTUT.EQ.LUNIT)  GOTO 1551
C--- NEW UNIT - GET REF
      CALL EPUNIT(LUNIT,IERR)
      IF(IERR.EQ.0)  GOTO 1552
      GOTO 77777
 1551 IERR=0
      IF(LREF.NE.0)  GOTO 1552
      IERR=13
      CALL EPERRH(LUNIT,IERR)
      GOTO 77777
 1552 CONTINUE
      LIST(ISTART+NUMBER)=IW
77777 RETURN
 9901 CONTINUE
C--- STATUS WORD REQUEST OUT OF RANGE
      IERR=16
      CALL EPERRH(LUNIT,IERR)
      GOTO 77777
      END
